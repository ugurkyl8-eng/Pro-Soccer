<!DOCTYPE html>  <html lang="tr">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">  
    <title>ProSoccer 2026 - Ultra Edition</title>  
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">  
    <style>  
        :root {  
            --primary: #2ecc71; /* Ã‡im yeÅŸili */  
            --dark: #1a1a1a;  
            --darker: #121212;  
            --light: #ecf0f1;  
            --accent: #e74c3c; /* KÄ±rmÄ±zÄ± kart/uyarÄ± */  
            --gold: #f1c40f;  
            --zuuks-orange: #ff8000;
            --efootball-pink: #ff00ff;
            --efootball-lime: #00ff00;
            --glass: rgba(20, 20, 20, 0.9);  
        }  * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', Roboto, sans-serif; user-select: none; }  
      
    body {  
        background-color: var(--darker);  
        color: var(--light);  
        height: 100vh;  
        overflow: hidden;  
        /* TELÄ°FSÄ°Z FUTBOL GÃ–RSELÄ° GÃœNCELLENDÄ° */
        background-image: url('https://images.unsplash.com/photo-1574629810360-7efbbe195018?q=80&w=2000&auto=format&fit=crop');   
        background-size: cover;  
        background-position: center;  
        background-attachment: fixed;  
    }  

    /* Sayfa YapÄ±sÄ± */  
    .page {  
        display: none;  
        flex-direction: column;  
        height: 100%;  
        width: 100%;  
        background: var(--glass);  
        backdrop-filter: blur(5px);  
        position: absolute;  
        top: 0;  
        left: 0;  
        overflow-y: auto;  
        padding: 20px;  
        animation: fadeIn 0.5s ease;  
    }  

    .active { display: flex !important; }  

    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }  

    /* --- YENÄ° ZUUKS INTRO --- */
    #intro-page {
        background: #ffffff !important; 
        z-index: 100000;
        padding: 0;
        display: flex;
        justify-content: center;
        align-items: center; 
        position: fixed;
        width: 100%;
        height: 100%;
        transition: opacity 1s ease-out;
    }

    .zuuks-logo-container {
        text-align: center;
        width: 100%;
        animation: logoScale 2s ease-in-out forwards;
    }

    .zuuks-text {
        font-family: 'Arial Black', Gadget, sans-serif; 
        font-size: 15vw; 
        color: #1a1a1a;
        letter-spacing: -5px; 
        font-weight: 900;
        font-style: italic; 
        text-transform: none;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .r-container {
        background-color: var(--zuuks-orange);
        color: white;
        padding: 0 10px;
        margin-left: 2px;
        position: relative;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        border-radius: 4px;
    }

    .r-plus {
        position: absolute;
        top: 5px;
        right: 5px;
        color: white;
        font-size: 25px;
        font-weight: bold;
        font-style: normal;
    }

    @keyframes logoScale {
        0% { transform: scale(0.8); opacity: 0; }
        20% { opacity: 1; }
        80% { transform: scale(1); opacity: 1; }
        100% { transform: scale(1.05); opacity: 1; }
    }
    
    /* --- SOCCER STAR BAÅžLAMA EKRANI --- */
    #start-screen {
        /* TELÄ°FSÄ°Z FUTBOL STADYUM GÃ–RSELÄ° GÃœNCELLENDÄ° */
        background: url('https://images.unsplash.com/photo-1522778119026-d647f0596c20?q=80&w=2000&auto=format&fit=crop') no-repeat center center !important;
        background-size: cover !important;
        backdrop-filter: none !important;
        padding: 0;
        position: relative;
        overflow: hidden;
    }

    .lightning-effect {
        position: absolute;
        width: 200%;
        height: 100%;
        background: linear-gradient(to bottom, rgba(0,0,0,0.3), transparent, rgba(0,0,0,0.7));
        top: 0; left: 0;
        z-index: 1;
        pointer-events: none;
    }

    .top-nav-container {
        position: absolute;
        top: 20px;
        right: 20px;
        display: flex;
        align-items: center;
        gap: 15px;
        z-index: 100;
    }

    .hamburger-dropdown {
        position: absolute;
        top: 50px;
        right: 0;
        background: var(--glass);
        border: 1px solid var(--primary);
        border-radius: 10px;
        width: 180px;
        display: none;
        flex-direction: column;
        overflow: hidden;
    }
    .hamburger-dropdown div {
        padding: 12px;
        border-bottom: 1px solid #333;
        font-size: 14px;
        cursor: pointer;
    }
    .hamburger-dropdown div:hover { background: var(--primary); color: #000; }

    .start-menu-btn {
        font-size: 28px;
        color: #fff;
        cursor: pointer;
        background: rgba(0,0,0,0.5);
        width: 50px;
        height: 50px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
    }

    .start-center-logo {
        position: absolute;
        top: 50px; 
        left: 50%;
        transform: translateX(-50%); 
        z-index: 5;
        text-align: center;
        width: 100%;
    }

    .bottom-start-container {
        position: absolute;
        bottom: 15%;
        width: 100%;
        text-align: center;
        z-index: 6;
    }

    .btn-big-start {
        background: linear-gradient(#2ecc71, #27ae60);
        color: #fff;
        padding: 20px 80px;
        font-size: 24px;
        font-weight: 900;
        border-radius: 15px;
        border: 4px solid #fff;
        box-shadow: 0 10px 0 #1e8449, 0 0 30px rgba(46, 204, 113, 0.4);
        display: inline-block;
        cursor: pointer;
        text-transform: uppercase;
        position: relative;
    }

    /* HakkÄ±mÄ±zda SayfasÄ± TasarÄ±mÄ± */
    .about-content {
        max-width: 800px;
        margin: 20px auto;
        padding: 20px;
        background: rgba(0,0,0,0.7);
        border-radius: 15px;
        line-height: 1.6;
        text-align: justify;
    }
    .about-social-buttons {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-top: 30px;
    }
    .social-btn {
        padding: 15px 30px;
        border-radius: 10px;
        text-decoration: none;
        font-weight: bold;
        color: white;
        display: flex;
        align-items: center;
        gap: 10px;
        transition: 0.3s;
    }
    .instagram-btn { background: linear-gradient(45deg, #f09433, #e6683c, #dc2743, #cc2366, #bc1888); }
    .youtube-btn { background: #ff0000; }
    .social-btn:hover { transform: translateY(-5px); opacity: 0.9; }

    /* EL ANÄ°MASYONU */
    .tutorial-hand {
        position: absolute;
        width: 50px;
        height: 50px;
        background: url('https://cdn-icons-png.flaticon.com/512/2037/2037237.png');
        background-size: contain;
        background-repeat: no-repeat;
        z-index: 9999;
        pointer-events: none;
        display: none;
    }

    @keyframes handTap {
        0% { transform: scale(1) translate(0, 0); }
        50% { transform: scale(0.8) translate(5px, 5px); }
        100% { transform: scale(1) translate(0, 0); }
    }

    .hand-animating {
        animation: handTap 0.6s infinite ease-in-out;
    }

    /* Formlar */  
    .form-container {  
        max-width: 400px;  
        margin: auto;  
        text-align: center;  
        background: rgba(0,0,0,0.8);  
        padding: 30px;  
        border-radius: 15px;  
        border: 1px solid var(--primary);  
        box-shadow: 0 0 20px rgba(46, 204, 113, 0.2);  
    }  

    input, select {  
        width: 100%;  
        padding: 15px;  
        margin: 10px 0;  
        background: #333;  
        border: 1px solid #444;  
        color: white;  
        border-radius: 8px;  
        font-size: 16px;  
    }  

    .btn {  
        width: 100%;  
        padding: 15px;  
        margin-top: 10px;  
        border: none;  
        border-radius: 8px;  
        font-size: 16px;  
        font-weight: bold;  
        cursor: pointer;  
        transition: 0.3s;  
        display: block;
        text-align: center;
        text-decoration: none;
    }  

    .btn-primary { background: var(--primary); color: #000; }  
    .btn-secondary { background: #34495e; color: white; }  
    .btn-danger { background: var(--accent); color: white; }  
    .btn-speed { background: var(--gold); color: #000; width: auto; display: inline-block; padding: 10px 20px; }  

    .link-text {  
        display: block;  
        margin-top: 15px;  
        color: var(--light);  
        text-decoration: underline;  
        cursor: pointer;  
        font-size: 14px;  
    }  

    .card-grid {  
        display: grid;  
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));  
        gap: 15px;  
        padding-bottom: 50px;  
    }  

    .card {  
        background: rgba(255,255,255,0.1);  
        padding: 15px;  
        border-radius: 10px;  
        text-align: center;  
        cursor: pointer;  
        border: 1px solid transparent;  
    }  

    .card:hover { border-color: var(--primary); background: rgba(46, 204, 113, 0.1); }  
    .card img { width: 50px; height: 50px; margin-bottom: 10px; }  
    .card h3 { font-size: 14px; margin-bottom: 5px; }  
    .card p { font-size: 12px; color: #aaa; }  

    .modal {  
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;  
        background: rgba(0,0,0,0.95);  
        display: none;  
        justify-content: center;  
        align-items: center;  
        z-index: 1000;  
    }  
    .contract-paper {  
        background: #ecf0f1;  
        color: #000;  
        padding: 30px;  
        width: 90%;  
        max-width: 500px;  
        border-radius: 5px;  
        font-family: 'Courier New', Courier, monospace;  
        position: relative;  
    }  
    .contract-paper h2 { text-align: center; border-bottom: 2px solid #000; padding-bottom: 10px; margin-bottom: 20px; }  
    .contract-sign-area { margin-top: 20px; border-top: 1px dashed #000; padding-top: 10px; }  

    .header {  
        display: flex; justify-content: space-between; align-items: center;  
        padding: 10px 0; border-bottom: 1px solid #333; margin-bottom: 20px;  
    }  
    .menu-btn { font-size: 24px; cursor: pointer; }  
    .money-badge { background: var(--gold); color: #000; padding: 5px 10px; border-radius: 20px; font-weight: bold; font-size: 14px; }  
      
    .match-card {  
        background: linear-gradient(45deg, #111, #222);  
        border: 1px solid var(--primary);  
        border-radius: 15px;  
        padding: 20px;  
        text-align: center;  
        margin-bottom: 20px;  
    }  
    .versus { display: flex; justify-content: space-around; align-items: center; margin: 20px 0; }  
    .team-logo-lg { width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 20px; }  
      
    .sidebar {  
        position: fixed; top: 0; right: -250px; width: 250px; height: 100%;  
        background: #111; border-left: 2px solid var(--primary);  
        transition: 0.3s; z-index: 2000; padding: 20px;  
    }  
    .sidebar.open { right: 0; }  
    .sidebar ul { list-style: none; margin-top: 50px; }  
    .sidebar li { padding: 15px 0; border-bottom: 1px solid #333; cursor: pointer; }  

    .match-screen-ui { text-align: center; }  
    .commentary-box {  
        height: 150px; overflow-y: auto; background: rgba(0,0,0,0.5);  
        border: 1px solid #555; padding: 10px; margin: 20px 0; text-align: left;  
        font-size: 14px;  
    }  
    .commentator { display: flex; gap: 10px; margin-bottom: 10px; align-items: center; }  
    .comm-avatar { width: 40px; height: 40px; border-radius: 50%; background: #555; flex-shrink: 0; }  
    .man { border: 2px solid #3498db; background-image: url('https://cdn-icons-png.flaticon.com/512/4140/4140048.png'); background-size: cover; }  
    .woman { border: 2px solid #e91e63; background-image: url('https://cdn-icons-png.flaticon.com/512/6997/6997662.png'); background-size: cover; }  
    .scoreboard { font-size: 40px; font-weight: bold; margin: 20px 0; font-family: monospace; }  
    .timer { font-size: 20px; color: var(--primary); }  

    .player-list-item {  
        display: flex; justify-content: space-between; align-items: center;  
        background: #222; margin-bottom: 5px; padding: 10px; border-radius: 5px;  
    }  
    .overall-badge {  
        background: #333; width: 30px; height: 30px; display: flex;   
        align-items: center; justify-content: center; border-radius: 5px; font-weight: bold;  
        color: var(--primary);  
    }  

    .toast {  
        position: fixed; top: 20px; left: 50%; transform: translateX(-50%);  
        background: var(--primary); color: #000; padding: 10px 20px;  
        border-radius: 20px; z-index: 3000; display: none; font-weight: bold;  
    }  

    table { width: 100%; border-collapse: collapse; font-size: 12px; }  
    th, td { padding: 8px; text-align: center; border-bottom: 1px solid #333; }  
    th { background: #222; }  
    tr:nth-child(1) td { color: var(--gold); font-weight: bold; } 
    tr:nth-child(2) td, tr:nth-child(3) td { color: #3498db; } 

    .tactics-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px; }
    .tactic-card { background: rgba(0,0,0,0.4); padding: 10px; border-radius: 10px; border: 1px solid #444; }
    .tactic-card label { font-size: 12px; color: var(--primary); display: block; margin-bottom: 5px; }

    .pitch-slot { 
        width: 50px; height: 50px; background: rgba(255,255,255,0.2); 
        border: 1px dashed white; border-radius: 50%; 
        display: flex; align-items: center; justify-content: center; 
        font-size: 10px; cursor: pointer; color: white;
    }
    .pitch-slot.occupied { background: var(--primary); border-style: solid; color: black; font-weight: bold; }

    /* Pozisyon Kategori BaÅŸlÄ±ÄŸÄ± */
    .pos-header {
        background: var(--primary);
        color: black;
        padding: 5px;
        font-weight: bold;
        margin: 10px 0 5px 0;
        border-radius: 4px;
        font-size: 14px;
    }

    /* --- YENÄ° EKLENEN STÄ°LLER --- */
    .league-finish-screen {
        background: url('https://images.unsplash.com/photo-1518091043644-c1d445eb9634?q=80&w=2000&auto=format&fit=crop') no-repeat center bottom !important;
        background-size: cover !important;
        text-align: center;
        display: none;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        color: white;
    }
    .cup-display {
        width: 200px;
        margin: 20px 0;
        filter: drop-shadow(0 0 20px gold);
    }
    .cup-title { font-size: 32px; font-weight: 900; color: var(--gold); text-shadow: 2px 2px 10px black; }
    .reward-text { font-size: 24px; margin: 10px 0; background: rgba(0,0,0,0.7); padding: 10px 20px; border-radius: 10px; border: 2px solid var(--gold); }
    
    .cl-theme { background: radial-gradient(circle, #1a2a6c, #b21f1f, #fdbb2d); }
    .el-theme { background: linear-gradient(135deg, #ff8008, #ffc837); }
    .conf-theme { background: linear-gradient(135deg, #00b09b, #96c93d); }
    .eliminated-theme { background: radial-gradient(circle, #8e0e00, #1f1c18) !important; }

    .draw-anim-container {
        width: 100%;
        max-width: 400px;
        background: rgba(0,0,0,0.8);
        border-radius: 20px;
        padding: 20px;
        margin-top: 20px;
    }
    .ball-container { display: flex; justify-content: center; gap: 10px; margin: 20px 0; }
    .draw-ball { width: 40px; height: 40px; background: white; border-radius: 50%; color: black; display: flex; align-items: center; justify-content: center; font-weight: bold; animation: bounce 0.5s infinite alternate; }
    @keyframes bounce { from { transform: translateY(0); } to { transform: translateY(-10px); } }

    /* YENÄ° AYARLAR BUTONU VE SAYFASI */
    .settings-btn-main {
        position: absolute;
        bottom: 20px;
        left: 20px;
        background: rgba(0,0,0,0.6);
        color: white;
        width: 60px;
        height: 60px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 30px;
        cursor: pointer;
        z-index: 1000;
        border: 2px solid white;
    }
    .settings-row {
        margin: 25px 0;
        text-align: left;
    }
    .settings-row label {
        display: block;
        margin-bottom: 10px;
        font-weight: bold;
        color: var(--primary);
    }
    .lang-btns {
        display: flex;
        gap: 10px;
    }
    .lang-opt {
        flex: 1;
        padding: 15px;
        background: #333;
        border-radius: 10px;
        text-align: center;
        cursor: pointer;
        border: 2px solid transparent;
    }
    .lang-opt.selected {
        border-color: var(--primary);
        background: #444;
    }
    input[type=range] {
        width: 100%;
        height: 10px;
        accent-color: var(--primary);
    }

</style>

</head>  
<body>  

<div id="intro-page">  
    <div class="zuuks-logo-container">
        <div class="zuuks-text">
            ProSocce<div class="r-container">r<span class="r-plus">+</span></div>
        </div>
    </div>
</div>

<div id="start-screen" class="page">
    <div class="lightning-effect"></div>
    
    <div class="top-nav-container">
        <div class="start-menu-btn" onclick="toggleHamburger()">
            <i class="fa-solid fa-bars"></i>
            <div id="hamburger-menu" class="hamburger-dropdown">
                <div onclick="showPage('login-page')" data-lang="login">GiriÅŸ Yap</div>
                <div onclick="showPage('register-page')" data-lang="register">KayÄ±t Ol</div>
                <div onclick="showPage('about-page')" data-lang="about">HakkÄ±mÄ±zda</div>
            </div>
        </div>
    </div>

    <div class="start-center-logo">
        <div class="zuuks-text" style="color: white; font-size: 11vw; text-shadow: 2px 2px 20px rgba(0,0,0,1);">
            ProSocce<div class="r-container">r<span class="r-plus">+</span></div>
        </div>
    </div>

    <div class="bottom-start-container">
        <div id="tutorial-hand" class="tutorial-hand"></div>
        <button id="main-start-btn" class="btn-big-start" onclick="startBtnClicked()" data-lang="start_btn">BAÅžLA</button>
    </div>

    <div class="settings-btn-main" onclick="showPage('settings-page')">
        <i class="fa-solid fa-gear"></i>
    </div>
</div>

<div id="toast" class="toast">Bildirim</div>  

<audio id="game-music" src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-15.mp3" loop></audio>
<audio id="sound-goal" src="https://www.myinstants.com/media/sounds/goal-sound-effect.mp3"></audio>
<audio id="sound-whistle" src="https://www.myinstants.com/media/sounds/referee-whistle.mp3"></audio>
<audio id="sound-click" src="https://cdn.pixabay.com/audio/2022/03/10/audio_c8c8a73056.mp3"></audio> <div id="settings-page" class="page" style="justify-content: center; align-items: center;">
    <div class="form-container" style="max-width: 500px; width: 90%;">
        <h2 data-lang="settings_title">AYARLAR</h2>
        
        <div class="settings-row">
            <label data-lang="select_lang">Dil SeÃ§ / Select Language</label>
            <div class="lang-btns">
                <div class="lang-opt" id="lang-tr" onclick="setLanguage('tr')">ðŸ‡¹ðŸ‡· TÃ¼rkÃ§e</div>
                <div class="lang-opt" id="lang-en" onclick="setLanguage('en')">ðŸ‡ºðŸ‡¸ English</div>
            </div>
        </div>

        <div class="settings-row">
            <label><i class="fa-solid fa-music"></i> <span data-lang="music_vol">MÃ¼zik</span> (<span id="music-val">100</span>%)</label>
            <input type="range" min="0" max="100" value="100" id="music-slider" oninput="updateVolume('music')">
        </div>

        <div class="settings-row">
            <label><i class="fa-solid fa-volume-high"></i> <span data-lang="sfx_vol">Ses Efektleri</span> (<span id="sfx-val">100</span>%)</label>
            <input type="range" min="0" max="100" value="100" id="sfx-slider" oninput="updateVolume('sfx')">
        </div>

        <button class="btn btn-primary" onclick="showPage('start-screen')" data-lang="save_back">KAYDET / GERÄ° DÃ–N</button>
    </div>
</div>

<div id="login-page" class="page" style="justify-content: center;">  
    <div class="form-container">  
        <h1 style="margin-bottom:20px; color:var(--primary);">ProSoccer <i class="fa-solid fa-futbol"></i></h1>  
        <h2 data-lang="login_title">GÄ°RÄ°Åž YAP</h2>  
        <input type="text" id="login-username" placeholder="KullanÄ±cÄ± AdÄ±" data-placeholder="username_ph">  
        <input type="password" id="login-password" placeholder="Åžifre" data-placeholder="password_ph">  
        <button class="btn btn-primary" onclick="handleLogin()" data-lang="login_btn">GÄ°RÄ°Åž YAP</button>  
        <span class="link-text" onclick="showPage('register-page')" data-lang="not_reg">KayÄ±t olmadÄ±n mÄ±?</span>  
        <span class="link-text" onclick="showPage('forgot-password-page')" data-lang="forgot_pass">Åžifremi Unuttum</span>  
        <span class="link-text" onclick="showPage('start-screen')" data-lang="back_btn">Geri DÃ¶n</span>  
    </div>  
</div>  

<div id="register-page" class="page" style="justify-content: center;">  
    <div class="form-container">  
        <h2 data-lang="register_title">KAYIT OL</h2>  
        <input type="text" id="reg-username" placeholder="KullanÄ±cÄ± AdÄ± (min 8 haneli, sayÄ± iÃ§ermeli)" data-placeholder="reg_u_ph">  
        <input type="email" id="reg-email" placeholder="Gmail (@gmail.com)" data-placeholder="reg_e_ph">  
        <input type="password" id="reg-password" placeholder="Åžifre (min 8 haneli, sayÄ± iÃ§ermeli)" data-placeholder="reg_p_ph">  
        <button class="btn btn-secondary" onclick="handleRegister()" data-lang="register_btn">KAYIT OL</button>  
        <span class="link-text" onclick="showPage('forgot-password-page')" data-lang="forgot_pass">Åžifremi Unuttum</span>  
        <span class="link-text" onclick="showPage('login-page')" data-lang="back_login">GiriÅŸ'e DÃ¶n</span>  
    </div>  
</div>  

<div id="forgot-password-page" class="page" style="justify-content: center;">  
    <div class="form-container">  
        <h2 data-lang="forgot_title">ÅžÄ°FREMÄ° UNUTTUM</h2>  
        <p style="font-size:12px; color:#aaa; margin-bottom:10px;" data-lang="forgot_info">KayÄ±tlÄ± bilgilerinizi giriniz.</p>  
        <input type="text" id="forgot-username" placeholder="KullanÄ±cÄ± AdÄ±" data-placeholder="username_ph">  
        <input type="email" id="forgot-email" placeholder="Gmail" data-placeholder="reg_e_ph">  
        <button class="btn btn-danger" onclick="handleForgotCheck()" data-lang="check_btn">Sorgula</button>  
        <span class="link-text" onclick="showPage('login-page')" data-lang="back_btn">Geri</span>  
    </div>  
</div>  

<div id="reset-password-page" class="page" style="justify-content: center;">  
    <div class="form-container">  
        <h2 data-lang="reset_title">ÅžÄ°FRE SIFIRLAMA</h2>  
        <input type="password" id="new-pass-1" placeholder="Yeni Åžifre (8 hane + sayÄ±)" data-placeholder="reg_p_ph">  
        <input type="password" id="new-pass-2" placeholder="Yeni Åžifre (Tekrar)" data-placeholder="new_p2_ph">  
        <button class="btn btn-primary" onclick="handleResetPassword()" data-lang="reset_btn">Åžifreyi Yenile</button>  
    </div>  
</div>  

<div id="about-page" class="page">
    <div class="header">
        <div onclick="showPage('start-screen')"><i class="fa-solid fa-arrow-left"></i> <span data-lang="back_btn">Geri</span></div>
        <h2 style="text-align:center; flex:1;" data-lang="about_title">HakkÄ±mÄ±zda</h2>  
    </div>
    <div class="about-content">
        <div id="about-text-container">
            </div>
        
        <div class="about-social-buttons">
            <a href="https://www.instagram.com/prosoccer2026?igsh=dml6bmF6dW12dDU0" target="_blank" class="social-btn instagram-btn">
                <i class="fa-brands fa-instagram"></i> Instagram
            </a>
            <a href="https://youtube.com/@zenixeditsyt?si=FwgOFtS7PYQL3EC-" target="_blank" class="social-btn youtube-btn">
                <i class="fa-brands fa-youtube"></i> Youtube
            </a>
        </div>
    </div>
</div>

<div id="league-select-page" class="page">  
    <div class="header">
        <div onclick="showPage('start-screen')"><i class="fa-solid fa-arrow-left"></i> <span data-lang="back_btn">Geri</span></div>
        <h2 style="text-align:center; flex:1;" data-lang="select_league">Lig SeÃ§</h2>  
    </div>
    <div class="card-grid">  
        <div class="card" onclick="selectLeague('super-lig')">  
            <i class="fa-solid fa-flag" style="font-size:30px; color:#e74c3c;"></i>  
            <h3 data-lang="super_lig">SÃ¼per Lig</h3>  
            <p data-lang="turkey">TÃ¼rkiye</p>  
        </div>  
        <div class="card" onclick="selectLeague('premier-lig')">  
            <i class="fa-solid fa-crown" style="font-size:30px; color:#9b59b6;"></i>  
            <h3 data-lang="premier_lig">Premier Lig</h3>  
            <p data-lang="england">Ä°ngiltere</p>  
        </div>  
        <div class="card" onclick="selectLeague('la-liga')">  
            <i class="fa-solid fa-sun" style="font-size:30px; color:#f1c40f;"></i>  
            <h3 data-lang="la_liga">La Liga</h3>  
            <p data-lang="spain">Ä°spanya</p>  
        </div>  
    </div>  
</div>  

<div id="team-select-page" class="page">  
    <div class="header">
        <div onclick="showPage('league-select-page')"><i class="fa-solid fa-arrow-left"></i> <span data-lang="back_to_leagues">Liglere DÃ¶n</span></div>
        <h2 style="text-align:center; flex:1;" data-lang="select_team">TakÄ±m SeÃ§</h2>  
    </div>
    <div id="team-list" class="card-grid">  
        </div>  
</div>  

<div id="contract-modal" class="modal">  
    <div class="contract-paper">  
        <h2 data-lang="contract_title">RESMÄ° SÃ–ZLEÅžME</h2>  
        <p><strong data-lang="team">TakÄ±m:</strong> <span id="contract-team-name"></span></p>  
        <p><strong data-lang="value">DeÄŸer:</strong> <span id="contract-team-value"></span></p>  
        <p><strong data-lang="player_count">Oyuncu SayÄ±sÄ±:</strong> <span id="contract-player-count"></span></p>  
        <p style="margin-top:20px; font-size:12px;" data-lang="contract_info">  
            Bu sÃ¶zleÅŸmeyi imzalayarak kulÃ¼bÃ¼n tÃ¼m sorumluluÄŸunu almayÄ±,   
            maÃ§lara Ã§Ä±kmayÄ± ve finansal yÃ¶netimi Ã¼stlenmeyi kabul ediyorsunuz.  
        </p>  
        <div class="contract-sign-area">  
            <p><span data-lang="user">KullanÄ±cÄ±:</span> <span id="contract-user-name">Misafir</span></p>  
            <button class="btn btn-primary" onclick="signContract()" data-lang="sign_btn">Ä°MZALA VE BAÅžLA</button>  
            <button class="btn btn-danger" style="margin-top:5px;" onclick="closeModal()" data-lang="cancel_btn">Ä°PTAL</button>  
        </div>  
    </div>  
</div>  

<div id="logout-confirm-modal" class="modal">
    <div class="form-container" style="background: white; color: black;">
        <h3 id="logout-message" style="margin-bottom: 20px;" data-lang="logout_msg">Ã‡Ä±kÄ±ÅŸ yapmak Ã¼zeresiniz.</h3>
        <button id="logout-primary-btn" class="btn btn-danger" onclick="confirmLogout('proceed')" data-lang="yes">Evet</button>
        <button class="btn btn-secondary" onclick="confirmLogout('cancel')" data-lang="back_btn">Geri DÃ¶n</button>
    </div>
</div>

<div id="dashboard-page" class="page">  
    <div class="header">  
        <div style="font-weight:bold;">ProSoccer</div>  
        <div class="money-badge"><i class="fa-solid fa-coins"></i> <span id="user-money">0</span>M</div>  
        <div class="menu-btn" onclick="toggleSidebar()"><i class="fa-solid fa-bars"></i></div>  
    </div>  

    <div class="match-card">  
        <h3 style="color:#aaa; font-size:14px;"><span data-lang="match">MAÃ‡</span> <span id="match-count-display">1</span> / 20</h3>  
        <div class="versus">  
            <div style="text-align:center;">  
                <div class="team-logo-lg" id="home-logo" style="background:gold; color:black;" data-lang="home_short">EV</div>  
                <span id="home-name">FenerbahÃ§e</span>  
            </div>  
            <div style="font-size:24px; font-weight:bold;">VS</div>  
            <div style="text-align:center;">  
                <div class="team-logo-lg" id="away-logo" style="background:gray; color:white;" data-lang="away_short">DEP</div>  
                <span id="away-name">Galatasaray</span>  
            </div>  
        </div>  
        <p style="font-size:12px; margin-bottom:10px;"><span data-lang="league_rank">Lig Konumu:</span> <span id="opponent-rank">2.</span> <span data-lang="rank_suffix">SÄ±ra</span></p>  
        <button id="start-match-btn" class="btn btn-primary" onclick="goToMatchScreen()" data-lang="start_match">MAÃ‡I BAÅžLAT</button>  
        <div id="cooldown-timer" style="margin-top:10px; color:var(--accent); display:none;"><span data-lang="next_match">Sonraki maÃ§:</span> <span id="cd-time">00:30</span></div>  
    </div>  

    <div style="background:rgba(0,0,0,0.5); padding:10px; border-radius:10px;">  
        <h4 data-lang="standings_mini">Lig Durumu (Ä°lk 5)</h4>  
        <div id="mini-standings"></div>  
    </div>  
</div>  

<div id="sidebar" class="sidebar">  
    <div style="text-align:right; font-size:24px;" onclick="toggleSidebar()">&times;</div>  
    <ul>  
        <li onclick="showPage('dashboard-page'); toggleSidebar()" data-lang="home">Ana Sayfa</li>  
        <li onclick="showSquad(); toggleSidebar()" data-lang="squad">Kadrom</li>  
        <li onclick="showTransferList(); toggleSidebar()" data-lang="transfer">Transfer Listesi</li>  
        <li onclick="showFormation(); toggleSidebar()" data-lang="lineup">DiziliÅŸ</li>  
        <li onclick="showTactics(); toggleSidebar()" data-lang="tactics">Taktikler</li>  
        <li onclick="showStandings(); toggleSidebar()" data-lang="table">Puan Durumu</li>  
        <li onclick="logout(); toggleSidebar()" style="color:var(--accent);" data-lang="logout">Ã‡Ä±kÄ±ÅŸ Yap</li>  
    </ul>  
</div>  

<div id="match-screen-page" class="page match-screen-ui">  
    <div class="header">  
        <h3 data-lang="match_day">MAÃ‡ GÃœNÃœ</h3>  
        <button id="speed-btn" class="btn-speed" onclick="toggleSpeed()" data-lang="speed_1x">HIZ: 1X</button>  
    </div>  
    <div style="display:flex; justify-content:space-between; padding:20px;">  
         <div id="m-home-name">EV</div>  
         <div class="timer" id="match-timer">00:00</div>  
         <div id="m-away-name">DEP</div>  
    </div>  
    <div class="scoreboard">  
        <span id="score-home">0</span> - <span id="score-away">0</span>  
    </div>  
      
    <div class="commentary-feed" id="commentary-feed" style="height: 150px; overflow-y: auto; background: rgba(0,0,0,0.5); border: 1px solid #555; padding: 10px; margin: 20px 0; text-align: left; font-size: 14px;">  
        </div>  

    <button id="start-simulation-btn" class="btn btn-primary" onclick="startMatchSimulation()" data-lang="kick_off">BAÅžLAMA DÃœDÃœÄžÃœ</button>
    <div id="half-time-controls" style="display:none;">
        <p style="color:var(--gold); margin-bottom:10px;" data-lang="half_time">Ä°LK YARI BÄ°TTÄ°!</p>
        <button class="btn btn-secondary" onclick="showTactics()" data-lang="change_tactic">TAKTÄ°K DEÄžÄ°ÅžTÄ°R</button>
        <button class="btn btn-primary" onclick="resumeMatchSimulation()" data-lang="start_2nd">2. YARIYA BAÅžLA</button>
    </div>
    <button id="end-match-btn" class="btn btn-secondary" style="display:none;" onclick="endMatch()" data-lang="exit_match">MAÃ‡TAN Ã‡IK</button>  
    <button id="match-stats-btn" class="btn btn-secondary" style="display:none;" onclick="showMatchStats()" data-lang="stats">Ä°STATÄ°STÄ°KLER</button>  
      
    <div id="match-stats-panel" style="display:none; text-align:left; font-size:12px; margin-top:20px; background:rgba(0,0,0,0.6); padding:15px; border-radius:10px;">  
        <h4 style="border-bottom:1px solid #555; padding-bottom:5px;" data-lang="match_summary">MaÃ§ Ã–zeti</h4>  
        <p id="stats-goals" style="color:var(--primary);"><span data-lang="goals">Goller:</span> </p>  
        <p id="stats-assists" style="color:var(--gold);"><span data-lang="assists">Asistler:</span> </p>
        <p id="stats-cards" style="color:var(--accent);"><span data-lang="cards">Kartlar:</span> </p>  
    </div>  
</div>  

<div id="league-finish-page" class="page league-finish-screen">
    <h1 id="finish-title" class="cup-title" data-lang="congrats">TEBRÄ°KLER!</h1>
    <img src="https://cdn-icons-png.flaticon.com/512/3112/3112946.png" class="cup-display" alt="Kupa">
    <h2 id="finish-rank-text">Ligi 1. SÄ±rada Bitirdiniz!</h2>
    <div id="finish-reward-text" class="reward-text">Ã–dÃ¼lÃ¼nÃ¼z: 20M</div>
    <button class="btn btn-primary" id="league-finish-btn" onclick="closeLeagueFinishPage()" data-lang="continue">DEVAM ET</button>
</div>

<div id="cup-draw-page" class="page" style="text-align:center; justify-content:center;">
    <h1 id="cup-name-draw" class="cup-title">ÅžAMPÄ°YONLAR LÄ°GÄ°</h1>
    <p data-lang="drawing">Kura Ã‡ekimi YapÄ±lÄ±yor...</p>
    <div class="draw-anim-container">
        <div class="ball-container">
            <div class="draw-ball">?</div>
            <div class="draw-ball">?</div>
        </div>
        <div id="draw-result" style="font-size:20px; font-weight:bold; margin-top:20px;"></div>
    </div>
    <button id="start-cup-match-btn" class="btn btn-primary" style="display:none; margin-top:20px;" onclick="goToMatchScreen()" data-lang="start_match">MAÃ‡I BAÅžLAT</button>
</div>

<div id="cup-result-page" class="page eliminated-theme" style="text-align:center; justify-content:center;">
    <h1 id="cup-res-title" data-lang="eliminated">ELENDÄ°NÄ°Z!</h1>
    <p id="cup-res-info">YarÄ± finalde veda ettiniz.</p>
    <div id="cup-res-money" class="reward-text">KazanÄ±lan: 10M</div>
    <button id="cup-action-btn" class="btn btn-primary" data-lang="start_new_season">YENÄ° SEZONA BAÅžLA</button>
</div>

<div id="squad-page" class="page">  
    <div class="header">  
         <div onclick="showPage('dashboard-page')"><i class="fa-solid fa-arrow-left"></i></div>  
         <div data-lang="squad">KADROM</div>  
         <div></div>  
    </div>  
    <div style="text-align:center; padding:10px;">  
        <h2 id="squad-team-name"></h2>  
        <p><span data-lang="total_value">Toplam DeÄŸer:</span> <span id="squad-total-value">0M</span></p>  
    </div>  
    <div id="my-players-list">  
        </div>  
</div>  

<div id="transfer-page" class="page">  
    <div class="header">  
        <div onclick="showPage('dashboard-page')"><i class="fa-solid fa-arrow-left"></i></div>  
        <div data-lang="transfer_market">TRANSFER MARKET</div>  
        <div><span id="transfer-money"></span>M</div>  
    </div>  
    <div id="transfer-list-container">  
        </div>  
    <div style="margin-top:30px;">  
        <h3 data-lang="transfer_history">Transfer GeÃ§miÅŸi</h3>  
        <ul id="transfer-history" style="font-size:12px; color:#aaa; list-style:none;"></ul>  
    </div>  
</div>  

<div id="standings-page" class="page">  
    <div class="header">  
        <div onclick="showPage('dashboard-page')"><i class="fa-solid fa-arrow-left"></i></div>  
        <div data-lang="table">PUAN DURUMU</div>  
        <div></div>  
    </div>  
    <div style="display:flex; gap:5px; margin-bottom:10px;">
        <button class="btn btn-speed" onclick="renderStandings('super-lig')">SÃ¼per Lig</button>
        <button class="btn btn-speed" onclick="renderStandings('premier-lig')">Premier</button>
        <button class="btn btn-speed" onclick="renderStandings('la-liga')">La Liga</button>
    </div>
    <div style="overflow-x:auto;">
        <table>  
            <thead>  
                <tr>  
                    <th data-lang="rank_head">SÄ±ra</th>  
                    <th data-lang="team_head">TakÄ±m</th>  
                    <th>O</th>  
                    <th>P</th>  
                    <th>Av</th>  
                </tr>  
            </thead>  
            <tbody id="standings-body"></tbody>  
        </table>  
    </div>
</div>  

<div id="formation-page" class="page">  
    <div class="header">  
        <div onclick="showPage('dashboard-page')"><i class="fa-solid fa-arrow-left"></i></div>  
        <div><span data-lang="lineup">DÄ°ZÄ°LÄ°Åž</span> (4-4-2)</div>  
        <div></div>  
    </div>  
    <div style="text-align:center; margin-top:20px;">  
        <p style="font-size:12px; color:#aaa; margin-bottom:10px;" data-lang="pitch_info">Mevkilere tÄ±klayarak oyuncu yerleÅŸtirin.</p>  
        <div id="soccer-pitch" style="background:linear-gradient(#2ecc71, #27ae60); width:280px; height:400px; margin:0 auto; border:4px solid white; position:relative; border-radius:5px;">  
            <div class="pitch-slot" id="pos-KL" style="position:absolute; bottom:10px; left:115px;" onclick="selectPlayerForPos('KL')">KL</div>  
            <div class="pitch-slot" id="pos-SLB" style="position:absolute; bottom:80px; left:10px;" onclick="selectPlayerForPos('SLB')">SLB</div>  
            <div class="pitch-slot" id="pos-STP1" style="position:absolute; bottom:80px; left:80px;"
 onclick="selectPlayerForPos('STP1')">STP</div>  
            <div class="pitch-slot" id="pos-STP2" style="position:absolute; bottom:80px; left:150px;" onclick="selectPlayerForPos('STP2')">STP</div>  
            <div class="pitch-slot" id="pos-SÄžB" style="position:absolute; bottom:80px; left:220px;" onclick="selectPlayerForPos('SÄžB')">SÄžB</div>  
              
            <div class="pitch-slot" id="pos-SLK" style="position:absolute; top:180px; left:10px;" onclick="selectPlayerForPos('SLK')">SLK</div>  
            <div class="pitch-slot" id="pos-OS1" style="position:absolute; top:180px; left:80px;" onclick="selectPlayerForPos('OS1')">OS</div>  
            <div class="pitch-slot" id="pos-OS2" style="position:absolute; top:180px; left:150px;" onclick="selectPlayerForPos('OS2')">OS</div>  
            <div class="pitch-slot" id="pos-SÄžK" style="position:absolute; top:180px; left:220px;" onclick="selectPlayerForPos('SÄžK')">SÄžK</div>  

            <div class="pitch-slot" id="pos-SNT1" style="position:absolute; top:50px; left:60px;" onclick="selectPlayerForPos('SNT1')">SNT</div>  
            <div class="pitch-slot" id="pos-SNT2" style="position:absolute; top:50px; left:170px;" onclick="selectPlayerForPos('SNT2')">SNT</div>  
        </div>  
    </div>  
</div>

<div id="tactics-page" class="page">
    <div class="header">  
        <div onclick="showPage('dashboard-page')"><i class="fa-solid fa-arrow-left"></i></div>  
        <div data-lang="tactics">TAKTIKLER
        div>  
        <div></div>  
    </div> 
    <div class="tactics-grid">
        <div class="tactic-card">
            <label data-lang="style_label">Oyun Stili</label>
            <select id="tactic-style">
                <option value="pasli" data-lang="opt_passing">PaslÄ± Oyun</option>
                <option value="kanat" data-lang="opt_wings">KanatlarÄ± Kullan</option>
                <option value="uzun" data-lang="opt_long">Uzun Top</option>
                <option value="kontra" data-lang="opt_counter">Kontra Atak</option>
            </select>
        </div>
        <div class="tactic-card">
            <label data-lang="marking_label">Markaj</label>
            <select id="tactic-marking">
                <option value="alan" data-lang="opt_area">Alan MarkajÄ±</option>
                <option value="adam" data-lang="opt_man">Adam MarkajÄ±</option>
            </select>
        </div>
        <div class="tactic-card">
                      <label data-lang="aggression_label">MÃ¼cadele</label>
            <select id="tactic-aggression">
                <option value="dikkatli" data-lang="opt_careful">Ã‡ok Dikkatli</option>
                <option value="normal" selected data-lang="opt_normal">Normal</option>
                <option value="agresif" data-lang="opt_aggressive">Agresif</option>
                <option value="cok-agresif" data-lang="opt_v_aggressive">Ã‡ok Agresif</option>
            </select>
        </div>
        <div class="tactic-card">
            <label data-lang="press_label">BaskÄ± (Press)</label>
            <select id="tactic-press">
                <option value="dÃ¼ÅŸÃ¼k" data-lang="opt_low">DÃ¼ÅŸÃ¼k BaskÄ±</option>
                <option value="dengeli" selected data-lang="opt_balanced">Dengeli</option>
                <option value="yÃ¼ksek" data-lang="opt_high">YÃ¼ksek BaskÄ±</option>
            </select>
        </div>
    </div>
    <button class="btn btn-primary" style="margin-top:20px;" onclick="saveTactics()" data-lang="save_tactics">AYARLARI KAYDET</button>
</div>

<div id="player-select-modal" class="modal">
    <div class="contract-paper" style="max-height:80vh; overflow-y:auto;">
        <h3 id="select-pos-title" data-lang="select_pos">Pozisyon SeÃ§</h3>
        <div id="available-players-list"></div>
        <button class="btn btn-danger" onclick="closePlayerModal()" data-lang="close">KAPAT</button>
    </div>
</div>

<script>  
    let handTimer;
    const HAND_DELAY = 1000; 

    // --- DÄ°L VERÄ°LERÄ° ---
    const langData = {
        tr: {
            login: "GiriÅŸ Yap", register: "KayÄ±t Ol", about: "HakkÄ±mÄ±zda", start_btn: "BAÅžLA", settings_title: "AYARLAR", select_lang: "Dil SeÃ§", music_vol: "MÃ¼zik", sfx_vol: "Ses Efektleri", save_back: "KAYDET / GERÄ° DÃ–N", login_title: "GÄ°RÄ°Åž YAP", username_ph: "KullanÄ±cÄ± AdÄ±", password_ph: "Åžifre", login_btn: "GÄ°RÄ°Åž YAP", not_reg: "KayÄ±t olmadÄ±n mÄ±?", forgot_pass: "Åžifremi Unuttum", back_btn: "Geri DÃ¶n", register_title: "KAYIT OL", reg_u_ph: "KullanÄ±cÄ± AdÄ± (8 hane + sayÄ±)", reg_e_ph: "Gmail (@gmail.com)", reg_p_ph: "Åžifre (8 hane + sayÄ±)", register_btn: "KAYIT OL", back_login: "GiriÅŸ'e DÃ¶n", forgot_title: "ÅžÄ°FREMÄ° UNUTTUM", forgot_info: "KayÄ±tlÄ± bilgilerinizi giriniz.", check_btn: "Sorgula", reset_title: "ÅžÄ°FRE SIFIRLAMA", new_p2_ph: "Yeni Åžifre (Tekrar)", reset_btn: "Åžifreyi Yenile", about_title: "HakkÄ±mÄ±zda", select_league: "Lig SeÃ§", super_lig: "SÃ¼per Lig", turkey: "TÃ¼rkiye", premier_lig: "Premier Lig", england: "Ä°ngiltere", la_liga: "La Liga", spain: "Ä°spanya", back_to_leagues: "Liglere DÃ¶n", select_team: "TakÄ±m SeÃ§", contract_title: "RESMÄ° SÃ–ZLEÅžME", team: "TakÄ±m", value: "DeÄŸer", player_count: "Oyuncu SayÄ±sÄ±", contract_info: "Bu sÃ¶zleÅŸmeyi imzalayarak kulÃ¼bÃ¼n tÃ¼m sorumluluÄŸunu almayÄ± kabul ediyorsunuz.", user: "KullanÄ±cÄ±", sign_btn: "Ä°MZALA VE BAÅžLA", cancel_btn: "Ä°PTAL", logout_msg: "Ã‡Ä±kÄ±ÅŸ yapmak Ã¼zeresiniz.", yes: "Evet", match: "MAÃ‡", home_short: "EV", away_short: "DEP", league_rank: "Lig Konumu", rank_suffix: "SÄ±ra", start_match: "MAÃ‡I BAÅžLAT", next_match: "Sonraki maÃ§", standings_mini: "Lig Durumu (Ä°lk 5)", home: "Ana Sayfa", squad: "Kadrom", transfer: "Transfer Listesi", lineup: "DiziliÅŸ", tactics: "Taktikler", table: "Puan Durumu", logout: "Ã‡Ä±kÄ±ÅŸ Yap", match_day: "MAÃ‡ GÃœNÃœ", speed_1x: "HIZ: 1X", kick_off: "BAÅžLAMA DÃœDÃœÄžÃœ", half_time: "Ä°LK YARI BÄ°TTÄ°!", change_tactic: "TAKTÄ°K DEÄžÄ°ÅžTÄ°R", start_2nd: "2. YARIYA BAÅžLA", exit_match: "MAÃ‡TAN Ã‡IK", stats: "Ä°STATÄ°STÄ°KLER", match_summary: "MaÃ§ Ã–zeti", goals: "Goller", assists: "Asistler", cards: "Kartlar", congrats: "TEBRÄ°KLER!", continue: "DEVAM ET", drawing: "Kura Ã‡ekimi YapÄ±lÄ±yor...", eliminated: "ELENDÄ°NÄ°Z!", start_new_season: "YENÄ° SEZONA BAÅžLA", total_value: "Toplam DeÄŸer", transfer_market: "TRANSFER MARKET", transfer_history: "Transfer GeÃ§miÅŸi", rank_head: "SÄ±ra", team_head: "TakÄ±m", pitch_info: "Mevkilere tÄ±klayarak oyuncu yerleÅŸtirin.", style_label: "Oyun Stili", opt_passing: "PaslÄ± Oyun", opt_wings: "KanatlarÄ± Kullan", opt_long: "Uzun Top", opt_counter: "Kontra Atak", marking_label: "Markaj", opt_area: "Alan MarkajÄ±", opt_man: "Adam MarkajÄ±", aggression_label: "MÃ¼cadele", opt_careful: "Ã‡ok Dikkatli", opt_normal: "Normal", opt_aggressive: "Agresif", opt_v_aggressive: "Ã‡ok Agresif", press_label: "BaskÄ± (Press)", opt_low: "DÃ¼ÅŸÃ¼k BaskÄ±", opt_balanced: "Dengeli", opt_high: "YÃ¼ksek BaskÄ±", save_tactics: "AYARLARI KAYDET", select_pos: "Pozisyon SeÃ§", close: "KAPAT", go_to_final: "FÄ°NAL MAÃ‡INA GÄ°T"
        },
        en: {
            login: "Login", register: "Register", about: "About Us", start_btn: "START", settings_title: "SETTINGS", select_lang: "Select Language", music_vol: "Music", sfx_vol: "SFX", save_back: "SAVE / BACK", login_title: "LOGIN", username_ph: "Username", password_ph: "Password", login_btn: "LOGIN", not_reg: "Not registered?", forgot_pass: "Forgot Password", back_btn: "Back", register_title: "REGISTER", reg_u_ph: "Username (8 chars + number)", reg_e_ph: "Gmail (@gmail.com)", reg_p_ph: "Password (8 chars + number)", register_btn: "REGISTER", back_login: "Back to Login", forgot_title: "FORGOT PASSWORD", forgot_info: "Enter your registered info.", check_btn: "Search", reset_title: "RESET PASSWORD", new_p2_ph: "New Password (Repeat)", reset_btn: "Reset Password", about_title: "About Us", select_league: "Select League", super_lig: "Super League", turkey: "Turkey", premier_lig: "Premier League", england: "England", la_liga: "La Liga", spain: "Spain", back_to_leagues: "Back to Leagues", select_team: "Select Team", contract_title: "OFFICIAL CONTRACT", team: "Team", value: "Value", player_count: "Players", contract_info: "By signing this, you take full responsibility for the club and management.", user: "User", sign_btn: "SIGN & START", cancel_btn: "CANCEL", logout_msg: "You are about to logout.", yes: "Yes", match: "MATCH", home_short: "HOME", away_short: "AWAY", league_rank: "League Rank", rank_suffix: "Pos", start_match: "START MATCH", next_match: "Next match", standings_mini: "League Standings (Top 5)", home: "Home", squad: "My Squad", transfer: "Transfer List", lineup: "Formation", tactics: "Tactics", table: "Standings", logout: "Logout", match_day: "MATCH DAY", speed_1x: "SPEED: 1X", kick_off: "KICK OFF", half_time: "HALF TIME!", change_tactic: "CHANGE TACTIC", start_2nd: "START 2nd HALF", exit_match: "EXIT MATCH", stats: "STATS", match_summary: "Match Summary", goals: "Goals", assists: "Assists", cards: "Cards", congrats: "CONGRATS!", continue: "CONTINUE", drawing: "Drawing Lots...", eliminated: "ELIMINATED!", start_new_season: "START NEW SEASON", total_value: "Total Value", transfer_market: "TRANSFER MARKET", transfer_history: "Transfer History", rank_head: "Rank", team_head: "Team", pitch_info: "Click positions to place players.", style_label: "Play Style", opt_passing: "Passing Game", opt_wings: "Wing Play", opt_long: "Long Ball", opt_counter: "Counter Attack", marking_label: "Marking", opt_area: "Zonal Marking", opt_man: "Man-to-Man", aggression_label: "Tackle", opt_careful: "Very Careful", opt_normal: "Normal", opt_aggressive: "Aggressive", opt_v_aggressive: "Very Aggressive", press_label: "Pressing", opt_low: "Low Press", opt_balanced: "Balanced", opt_high: "High Press", save_tactics: "SAVE TACTICS", select_pos: "Select Position", close: "CLOSE", go_to_final: "GO TO FINAL"
        }
    };

    window.addEventListener('load', function() {
        setTimeout(() => {
            const intro = document.getElementById('intro-page');
            intro.style.opacity = '0';
            setTimeout(() => {
                intro.style.display = 'none';
                showPage('start-screen');
                // MÃ¼ziÄŸi baÅŸlat
                const music = document.getElementById('game-music');
                music.play().catch(() => {
                    console.log("MÃ¼zik etkileÅŸim bekliyor.");
                });
            }, 1000); 
        }, 3000); 
    });

    const TEAMS_DATA = {  
        "super-lig": [  
            { name: "Istanbul Yellow", value: 274, pCount: 31, color: "yellow" },  
            { name: "Istanbul Red", value: 289, pCount: 27, color: "red" },  
            { name: "Istanbul Black", value: 154, pCount: 29, color: "black" },  
            { name: "Trabzon Blue", value: 106, pCount: 29, color: "purple" },  
            { name: "Istanbul Orange", value: 70, pCount: 29, color: "orange" },  
            { name: "Kayseri Yellow", value: 21, pCount: 28, color: "gold" },  
            { name: "Samsun Red", value: 51, pCount: 29, color: "red" },  
            { name: "GÃ¶ztepe Y.R", value: 40, pCount: 25, color: "yellow" },  
            { name: "Konya G.W", value: 30, pCount: 41, color: "white" },  
            { name: "Alanya O.G", value: 26, pCount: 29, color: "orange" }  
        ],  
        "la-liga": [  
            { name: "MD White", value: 1350, pCount: 24, color: "white" },  
            { name: "Catolonia FC", value: 1112, pCount: 24, color: "blue" },  
            { name: "Andalusia FC", value: 132, pCount: 28, color: "red" },  
            { name: "Madrid Rosas", value: 598, pCount: 23, color: "red" },  
            { name: "Vila Yellow FC", value: 263, pCount: 26, color: "yellow" },  
            { name: "Cornella Blue", value: 107, pCount: 24, color: "blue" },
            { name: "Vasconia", value: 250, pCount: 26, color: "blue" },  
            { name: "Heliopolis", value: 220, pCount: 26, color: "green" },  
            { name: "Geta Blue", value: 68, pCount: 22, color: "blue" },  
            { name: "Cid Valencia", value: 156, pCount: 23, color: "white" }  
        ],  
        "premier-lig": [  
            { name: "Man Blue", value: 1221, pCount: 27, color: "skyblue" },  
            { name: "North London", value: 1331, pCount: 25, color: "red" },  
            { name: "Tottenham White", value: 838, pCount: 27, color: "white" },  
            { name: "London FC", value: 1118, pCount: 31, color: "blue" },  
            { name: "West Midlands", value: 527, pCount: 24, color: "purple" },  
            { name: "Merseyside Red", value: 1004, pCount: 26, color: "red" },  
            { name: "Man Red", value: 720, pCount: 26, color: "red" },  
            { name: "Merseyside Blue", value: 402, pCount: 25, color: "blue" },  
            { name: "South London B", value: 536, pCount: 29, color: "blue" },  
            { name: "Brighton Blue", value: 526, pCount: 28, color: "blue" }  
        ]  
    };  

    const LEAGUE_REWARDS = {
        "super-lig": [20, 15, 12, 10, 7, 5, 4, 3, 2, 1],
        "premier-lig": [40, 35, 30, 25, 20, 17, 15, 12, 10, 7],
        "la-liga": [40, 30, 27, 25, 20, 17, 15, 12, 10, 5]
    };

    const PLAYER_NAMES = ["Icardi", "Dzeko", "Tadic", "Muslera", "Gedson", "Immobile", "Visca", "Mertens", "Fred", "Ferdi", "Semih", "BarÄ±ÅŸ", "Kerem", "Torreira", "Szymanski", "Livakovic", "Onana", "Rashica", "Muci", "Rafa Silva", "Osimhen", "Davinson", "Nelsson", "Abdulkerim", "Osayi", "Djiku", "Becao", "Ä°rfan", "Yunus", "Batshuayi", "Pepe", "Trezeguet", "Mendy", "UÄŸurcan", "Piatek", "Davidson", "Januzaj", "Okaka", "Balotelli", "Nani", "Ali", "Veli", "Ahmet", "Mehmet", "Can", "Burak", "Cenk", "Hakan", "Arda", "Kenan", "Salih", "Mert"];  
    const SURNAMES = ["YÄ±lmaz", "Kaya", "Demir", "Ã‡elik", "Åžahin", "YÄ±ldÄ±z", "Ã–ztÃ¼rk", "AydÄ±n", "Ã–zdemir", "Arslan", "KoÃ§", "Kurt", "Tekin", "YalÃ§Ä±n", "ErdoÄŸan", "Aslan", "Polat", "GÃ¼ler", "Tosun", "Ãœnder"];  

    let gameState = {  
        user: null, team: null, league: null, money: 0, players: [], fixture: [], currentMatchIndex: 0, standings: {}, lastMatchTime: 0,
        tactics: { style: 'pasli', marking: 'alan', aggression: 'normal', press: 'dengeli' },
        lineup: {},
        moral: 0,
        halfTimeTacticUsed: false,
        season: 1,
        isCupActive: false,
        cupName: "",
        cupStage: "YarÄ± Final",
        settings: {
            lang: "tr",
            musicVol: 100,
            sfxVol: 100
        }
    };  

    let matchInterval = null;  
    let matchSpeed = 1000; 
    let isMatchRunning = false;  
    let currentMatchSecond = 0;  
    let isSecondHalf = false;  
    let matchEvents = { goals: [], assists: [], redCards: [] };
    let homeScore = 0; 
    let awayScore = 0;

    const registeredUsers = JSON.parse(localStorage.getItem('proSoccerUsers')) || [];  

    document.addEventListener('click', function(e) {
        if(e.target.tagName === 'BUTTON' || e.target.closest('.card') || e.target.classList.contains('menu-btn') || e.target.classList.contains('pitch-slot') || e.target.classList.contains('start-menu-btn') || e.target.classList.contains('settings-btn-main') || e.target.classList.contains('lang-opt')) {
            playSound('sound-click');
            // MÃ¼zik Ã§almaya baÅŸlamamÄ±ÅŸsa (browser engeli) burada zorla baÅŸlat
            const music = document.getElementById('game-music');
            if(music.paused && gameState.settings.musicVol > 0) music.play();
        }
        if(document.getElementById('start-screen').classList.contains('active')) {
            resetHandTimer();
        }
    });

    function setLanguage(lang) {
        gameState.settings.lang = lang;
        updateLanguageUI();
        saveGame();
    }

    function updateLanguageUI() {
        const lang = gameState.settings.lang;
        const data = langData[lang];

        // SeÃ§ili dili gÃ¶rsel olarak iÅŸaretle
        document.querySelectorAll('.lang-opt').forEach(el => el.classList.remove('selected'));
        document.getElementById(`lang-${lang}`).classList.add('selected');

        // Text Contentleri GÃ¼ncelle
        document.querySelectorAll('[data-lang]').forEach(el => {
            const key = el.getAttribute('data-lang');
            if(data[key]) el.innerText = data[key];
        });

        // PlaceholderlarÄ± GÃ¼ncelle
        document.querySelectorAll('[data-placeholder]').forEach(el => {
            const key = el.getAttribute('data-placeholder');
            if(data[key]) el.placeholder = data[key];
        });

        // HakkÄ±mÄ±zda Metni (Ã–zel durum)
        const aboutContainer = document.getElementById('about-text-container');
        if(lang === 'tr') {
            aboutContainer.innerHTML = `<p>Bu oyun, 3 Ocak 2026 tarihinde geliÅŸtirilme sÃ¼recine baÅŸlanmÄ±ÅŸ bir projedir...</p><br><p>AmacÄ±mÄ±z TÃ¼rk bir geliÅŸtirici olarak keyifli bir futbol deneyimi sunmaktÄ±r.</p>`;
        } else {
            aboutContainer.innerHTML = `<p>This game is a project started on January 3, 2026...</p><br><p>Our goal is to provide a fun football experience as a Turkish developer.</p>`;
        }
    }

    function updateVolume(type) {
        if(type === 'music') {
            const val = document.getElementById('music-slider').value;
            gameState.settings.musicVol = parseInt(val);
            document.getElementById('music-val').innerText = val;
            document.getElementById('game-music').volume = val / 100;
        } else {
            const val = document.getElementById('sfx-slider').value;
            gameState.settings.sfxVol = parseInt(val);
            document.getElementById('sfx-val').innerText = val;
        }
        saveGame();
    }

    function toggleHamburger() {
        const m = document.getElementById('hamburger-menu');
        m.style.display = (m.style.display === 'flex') ? 'none' : 'flex';
    }

    function showPage(pageId) {  
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));  
        const targetPage = document.getElementById(pageId);
        if(targetPage) targetPage.classList.add('active');
        
        if(pageId === 'start-screen') {
            resetHandTimer();
        } else {
            const hm = document.getElementById('hamburger-menu');
            if(hm) hm.style.display = 'none';
            stopHandAnim();
        }
        updateLanguageUI();
    }  

    function resetHandTimer() {
        stopHandAnim();
        handTimer = setTimeout(startHandAnim, HAND_DELAY);
    }

    function startHandAnim() {
        const hand = document.getElementById('tutorial-hand');
        const btn = document.getElementById('main-start-btn');
        if(!hand || !btn || !document.getElementById('start-screen').classList.contains('active')) return;

        const rect = btn.getBoundingClientRect();
        hand.style.left = (rect.left + rect.width / 2) + 'px';
        hand.style.top = (rect.top + rect.height / 2) + 'px';
        
        hand.style.display = 'block';
        hand.classList.add('hand-animating');
    }

    function stopHandAnim() {
        clearTimeout(handTimer);
        const hand = document.getElementById('tutorial-hand');
        if(hand) {
            hand.style.display = 'none';
            hand.classList.remove('hand-animating');
        }
    }

    function startBtnClicked() {
        stopHandAnim();
        showPage('league-select-page');
    }

    function toast(msg) {  
        const t = document.getElementById('toast');  
        t.innerText = msg;  
        t.style.display = 'block';  
        setTimeout(() => t.style.display = 'none', 3000);  
    }  

    function playSound(id) {
        const s = document.getElementById(id);
        if(s) { 
            s.currentTime = 0; 
            s.volume = gameState.settings.sfxVol / 100;
            s.play().catch(e => {}); 
        }
    }

    function saveGame() {
        const key = gameState.user ? 'proSoccerSave_' + gameState.user.u : 'proSoccerSave_Guest';
        localStorage.setItem(key, JSON.stringify(gameState));
    }

    function loadGame(username) {
        const key = username ? 'proSoccerSave_' + username : 'proSoccerSave_Guest';
        const savedData = localStorage.getItem(key);
        if(savedData) { 
            let parsed = JSON.parse(savedData);
            if(parsed.currentMatchIndex < 20) {
                document.getElementById('league-finish-page').style.display = 'none';
                document.getElementById('league-finish-page').classList.remove('active');
            }
            gameState = parsed; 
            // Ses ve dil ayarlarÄ±nÄ± uygula
            document.getElementById('game-music').volume = gameState.settings.musicVol / 100;
            document.getElementById('music-slider').value = gameState.settings.musicVol;
            document.getElementById('music-val').innerText = gameState.settings.musicVol;
            document.getElementById('sfx-slider').value = gameState.settings.sfxVol;
            document.getElementById('sfx-val').innerText = gameState.settings.sfxVol;
            updateLanguageUI();
            return true; 
        }
        return false;
    }

    function handleRegister() {  
        const u = document.getElementById('reg-username').value;  
        const e = document.getElementById('reg-email').value;  
        const p = document.getElementById('reg-password').value;  

        const checkDup = registeredUsers.find(acc => acc.u === u || acc.e === e);
        if(checkDup) return toast(gameState.settings.lang === 'tr' ? "Bu kullanÄ±cÄ± zaten var!" : "User already exists!");

        if (u.length < 8 || !/\d/.test(u)) return toast("Min 8 chars + number!");  
        if (!e.includes("@gmail.com")) return toast("Must be @gmail.com!");  
        if (p.length < 8 || !/\d/.test(p)) return toast("Password min 8 chars!");  
        registeredUsers.push({ u, e, p });  
        localStorage.setItem('proSoccerUsers', JSON.stringify(registeredUsers));  
        toast("Success!");  
        showPage('login-page');  
    }  

    function handleLogin() {  
        const u = document.getElementById('login-username').value;  
        const p = document.getElementById('login-password').value;  
        const user = registeredUsers.find(acc => acc.u === u && acc.p === p);  
        if (user) { 
            if(loadGame(u)) {
                toast("Game Loaded!");
                showPage('dashboard-page');
                updateDashboard();
                updatePitchUI(); 
            } else {
                gameState.user = user; 
                toast("Welcome!"); 
                showPage('league-select-page'); 
            }
        } 
        else { toast("Error!"); }  
    }  

    let resetUser = null;  
    function handleForgotCheck() {  
        const u = document.getElementById('forgot-username').value;  
        const e = document.getElementById('forgot-email').value;  
        resetUser = registeredUsers.find(acc => acc.u === u && acc.e === e);  
        if (resetUser) { showPage('reset-password-page'); } else { toast("Error!"); }  
    }  

    function handleResetPassword() {  
        const p1 = document.getElementById('new-pass-1').value;  
        const p2 = document.getElementById('new-pass-2').value;  
        if (p1 === resetUser.p) return toast("Cannot be same!");
        if (p1 !== p2) return toast("No match!");  
        resetUser.p = p1;  
        localStorage.setItem('proSoccerUsers', JSON.stringify(registeredUsers));  
        toast("Done!");  
        showPage('login-page');  
    }  

    function selectLeague(leagueKey) {  
        gameState.league = leagueKey;  
        const container = document.getElementById('team-list');  
        container.innerHTML = "";  
        TEAMS_DATA[leagueKey].forEach(team => {  
            const div = document.createElement('div');  
            div.className = 'card';  
            div.innerHTML = `<div style="width:50px; height:50px; background:${team.color}; border-radius:50%; margin:0 auto 10px auto;"></div><h3>${team.name}</h3><p>${team.value}M</p>`;  
            div.onclick = () => openContract(team);  
            container.appendChild(div);  
        });  
        showPage('team-select-page');  
    }  

    let selectedTeamTemp = null;  
    function openContract(team) {  
        selectedTeamTemp = team;  
        document.getElementById('contract-team-name').innerText = team.name;  
        document.getElementById('contract-team-value').innerText = team.value + "M";  
        document.getElementById('contract-player-count').innerText = team.pCount;  
        document.getElementById('contract-user-name').innerText = gameState.user ? gameState.user.u : "Guest";  
        document.getElementById('contract-modal').style.display = 'flex';  
    }  

    function closeModal() { document.getElementById('contract-modal').style.display = 'none'; }  

    function signContract() {  
        gameState.team = selectedTeamTemp;  
        gameState.money = (gameState.team.value > 600) ? 50 : 25;  
        gameState.currentMatchIndex = 0;
        gameState.season = 1;
        generateMyPlayers();  
        createFixture();  
        closeModal();  
        saveGame(); 
        updateDashboard();  
        showPage('dashboard-page');  
    }  

    function generateMyPlayers() {  
        gameState.players = [];  
        const positions = ["KL", "SLB", "STP", "STP", "SÄžB", "OS", "OS", "SLK", "SNT", "SNT", "SÄžK"];  
        for(let i=0; i<gameState.team.pCount; i++) {  
            let ovr = randomInt(60, 85); 
            let val = randomInt(5, 50);  
            let pos = positions[i % 11];  
            gameState.players.push({ id: i, name: PLAYER_NAMES[randomInt(0, PLAYER_NAMES.length-1)] + " " + SURNAMES[randomInt(0, SURNAMES.length-1)], pos: pos, ovr: ovr, value: val, goals: 0, assists: 0 });  
        }  
    }  

    function createFixture() {  
        const leagueTeams = TEAMS_DATA[gameState.league];  
        gameState.fixture = [];  
        gameState.standings = {};

        for (let lig in TEAMS_DATA) {
            TEAMS_DATA[lig].forEach(t => { 
                gameState.standings[t.name] = { p:0, w:0, d:0, l:0, gf:0, ga:0, av:0, lig: lig }; 
            });
        }

        for(let i=0; i<20; i++) {
            let opp = leagueTeams[randomInt(0, leagueTeams.length - 1)];
            while(opp.name === gameState.team.name) {
                opp = leagueTeams[randomInt(0, leagueTeams.length - 1)];
            }
            gameState.fixture.push({ opponent: opp, home: (i % 2 === 0) });
        }
    }  

    function updateDashboard() {  
        document.getElementById('user-money').innerText = gameState.money.toFixed(1);  
        document.getElementById('match-count-display').innerText = gameState.currentMatchIndex + 1;

        if(gameState.currentMatchIndex < gameState.fixture.length) {  
            const match = gameState.fixture[gameState.currentMatchIndex];  
            document.getElementById('home-name').innerText = match.home ? gameState.team.name : match.opponent.name;  
            document.getElementById('away-name').innerText = !match.home ? gameState.team.name : match.opponent.name;  
            
            const sorted = Object.keys(gameState.standings)
                .filter(n => gameState.standings[n].lig === gameState.league)
                .sort((a,b) => gameState.standings[b].p - gameState.standings[a].p);
            const rank = sorted.indexOf(match.opponent.name) + 1;
            document.getElementById('opponent-rank').innerText = rank + ".";
        }  
        renderMiniStandings();  
    }  

    function toggleSidebar() { document.getElementById('sidebar').classList.toggle('open'); }  

    function toggleSpeed() {  
        if(matchSpeed === 1000) { matchSpeed = 500; document.getElementById('speed-btn').innerText = gameState.settings.lang === 'tr' ? "HIZ: 2X" : "SPEED: 2X"; } 
        else if(matchSpeed === 500) { matchSpeed = 250; document.getElementById('speed-btn').innerText = gameState.settings.lang === 'tr' ? "HIZ: 4X" : "SPEED: 4X"; }
        else { matchSpeed = 1000; document.getElementById('speed-btn').innerText = gameState.settings.lang === 'tr' ? "HIZ: 1X" : "SPEED: 1X"; }  
        if(isMatchRunning) { clearInterval(matchInterval); runMatchLoop(); }  
    }  

    function goToMatchScreen() {  
        gameState.lastMatchTime = Date.now();  
        showPage('match-screen-page');  
        
        let match;
        if(gameState.isCupActive) {
            match = { opponent: { name: gameState.cupOpponent.name }, home: true };
        } else {
            match = gameState.fixture[gameState.currentMatchIndex];
        }

        document.getElementById('m-home-name').innerText = match.home ? gameState.team.name : match.opponent.name;  
        document.getElementById('m-away-name').innerText = !match.home ? gameState.team.name : match.opponent.name;  
        document.getElementById('score-home').innerText = "0";  
        document.getElementById('score-away').innerText = "0";  
        document.getElementById('commentary-feed').innerHTML = "";  
        document.getElementById('start-simulation-btn').style.display = 'inline-block';  
        document.getElementById('half-time-controls').style.display = 'none';
        document.getElementById('end-match-btn').style.display = 'none';  
        document.getElementById('match-stats-btn').style.display = 'none';  
        document.getElementById('match-stats-panel').style.display = 'none';  
        
        const comm = gameState.settings.lang === 'tr' ? "Ertem Åžener: Merhabalar! MÃ¼thiÅŸ bir maÃ§ bizi bekliyor." : "Commentator: Hello! A great match is about to start.";
        addCommentary("man", comm);  
    }  

    function startMatchSimulation() {  
        document.getElementById('start-simulation-btn').style.display = 'none';  
        currentMatchSecond = 0; homeScore = 0; awayScore = 0;  
        matchEvents = { goals: [], assists: [], redCards: [] };
        gameState.moral = 0;
        gameState.halfTimeTacticUsed = false;
        isMatchRunning = true;  
        isSecondHalf = false;  
        playSound('sound-whistle');
        runMatchLoop();  
    }  

    function resumeMatchSimulation() {
        document.getElementById('half-time-controls').style.display = 'none';
        isMatchRunning = true;
        isSecondHalf = true;
        playSound('sound-whistle');
        runMatchLoop();
    }

    function runMatchLoop() {  
        let match;
        if(gameState.isCupActive) {
            match = { opponent: gameState.cupOpponent, home: true };
        } else {
            match = gameState.fixture[gameState.currentMatchIndex];
        }

        matchInterval = setInterval(() => {  
            currentMatchSecond++;  
            document.getElementById('match-timer').innerText = (currentMatchSecond < 10 ? "0"+currentMatchSecond : currentMatchSecond) + ":00";  
              
            if(currentMatchSecond === 45 && !isSecondHalf) {  
                clearInterval(matchInterval);
                isMatchRunning = false;
                document.getElementById('half-time-controls').style.display = 'block';
                playSound('sound-whistle'); 
                addCommentary("man", gameState.settings.lang === 'tr' ? "Ertem: Ä°lk yarÄ± bitti!" : "Comm: Half time!");
                return;
            }  

            let myProb = (gameState.team.value / (gameState.team.value + match.opponent.value)) * 100;
            
            if(Math.random() < 0.06) {  
                if(Math.random() * 100 < myProb) {  
                    if(match.home) homeScore++; else awayScore++;  
                    playSound('sound-goal');
                    gameState.moral += 1; 
                    const scorer = gameState.players[randomInt(0, gameState.players.length-1)];
                    matchEvents.goals.push(scorer.name);
                    const txt = gameState.settings.lang === 'tr' ? `GOOOOOL! ${scorer.name} attÄ±!` : `GOAL! ${scorer.name} scores!`;
                    addCommentary("man", `${txt} (${homeScore}-${awayScore})`);  
                } else {  
                    if(match.home) awayScore++; else homeScore++;  
                    playSound('sound-goal'); 
                    gameState.moral -= 1;
                    const txt = gameState.settings.lang === 'tr' ? "Eyvah! Rakip golÃ¼ buldu..." : "Oh no! Opponent scores...";
                    addCommentary("man", txt);  
                }  
                updateScore(homeScore, awayScore);  
            }

            if(currentMatchSecond >= 90) {  
                clearInterval(matchInterval);  
                isMatchRunning = false;  
                playSound('sound-whistle');
                finishMatch(homeScore, awayScore);  
                document.getElementById('end-match-btn').style.display = 'inline-block';  
                document.getElementById('match-stats-btn').style.display = 'inline-block';  
            }  
        }, matchSpeed);  
    }  

    function updateScore(h, a) { document.getElementById('score-home').innerText = h; document.getElementById('score-away').innerText = a; }  

    function addCommentary(person, text) {  
        const box = document.getElementById('commentary-feed');  
        const div = document.createElement('div');  
        div.className = 'commentator';  
        div.innerHTML = `<div class="comm-avatar ${person}"></div><span>${text}</span>`;  
        box.prepend(div);  
    }  

    function finishMatch(h, a) {  
        if(gameState.isCupActive) {
            handleCupMatchResult(h, a);
            return;
        }

        const match = gameState.fixture[gameState.currentMatchIndex];  
        const myScore = match.home ? h : a;  
        const oppScore = match.home ? a : h;  
        
        if(myScore > oppScore) gameState.money += 1.5;  
        
        updateStandingData(gameState.team.name, myScore, oppScore);  
        updateStandingData(match.opponent.name, oppScore, myScore);  
        
        simulateBotMatches();

        gameState.currentMatchIndex++;  
        document.getElementById('stats-goals').innerText = (gameState.settings.lang === 'tr' ? 'Goller: ' : 'Goals: ') + matchEvents.goals.join(", ");
        
        if(gameState.currentMatchIndex >= 20) {
            setTimeout(showLeagueFinishPage, 1500);
        }

        saveGame(); 
    }  

    function showLeagueFinishPage() {
        const sorted = Object.keys(gameState.standings)
            .filter(n => gameState.standings[n].lig === gameState.league)
            .sort((a,b) => gameState.standings[b].p - gameState.standings[a].p);
        
        const myRank = sorted.indexOf(gameState.team.name) + 1;
        const rewardList = LEAGUE_REWARDS[gameState.league];
        const reward = rewardList[myRank - 1] || 1;
        
        gameState.money += reward;
        
        let cupName = "ProSoccerCup";
        if(gameState.league === "super-lig") cupName = "SÃ¼per Pro Soccer";
        else if(gameState.league === "la-liga") cupName = "La Pro Soccer";
        else if(gameState.league === "premier-lig") cupName = "Premier Pro Soccer";

        const title = gameState.settings.lang === 'tr' ? (myRank === 1 ? `ÅžAMPÄ°YON! ${cupName}` : `TEBRÄ°KLER! ${cupName}`) : (myRank === 1 ? `CHAMPION! ${cupName}` : `CONGRATS! ${cupName}`);
        document.getElementById('finish-title').innerText = title;
        document.getElementById('finish-rank-text').innerText = (gameState.settings.lang === 'tr' ? `Ligi ${myRank}. SÄ±rada Bitirdiniz!` : `You finished rank ${myRank}!`);
        document.getElementById('finish-reward-text').innerText = (gameState.settings.lang === 'tr' ? `Ã–dÃ¼lÃ¼nÃ¼z: ${reward}M` : `Reward: ${reward}M`);
        
        document.getElementById('league-finish-page').style.display = 'flex';
        document.getElementById('league-finish-page').classList.add('active');
        saveGame();
    }

    function closeLeagueFinishPage() {
        document.getElementById('league-finish-page').style.display = 'none';
        document.getElementById('league-finish-page').classList.remove('active');
        checkCupQualification();
    }

    function checkCupQualification() {
        const sorted = Object.keys(gameState.standings)
            .filter(n => gameState.standings[n].lig === gameState.league)
            .sort((a,b) => gameState.standings[b].p - gameState.standings[a].p);
        const myRank = sorted.indexOf(gameState.team.name) + 1;

        gameState.isCupActive = true;
        gameState.cupStage = "YarÄ± Final";

        if(myRank <= 2) {
            startCupDraw(gameState.settings.lang === 'tr' ? "ÅžAMPÄ°YONLAR LÄ°GÄ°" : "CHAMPIONS LEAGUE", "cl-theme");
        } else if(myRank <= 4) {
            startCupDraw(gameState.settings.lang === 'tr' ? "AVRUPA LÄ°GÄ°" : "EUROPA LEAGUE", "el-theme");
        } else if(myRank <= 6) {
            startCupDraw(gameState.settings.lang === 'tr' ? "KONFERANS LÄ°GÄ°" : "CONFERENCE LEAGUE", "conf-theme");
        } else {
            toast(gameState.settings.lang === 'tr' ? "Yeni sezon baÅŸlÄ±yor!" : "New season starting!");
            startNewSeason();
        }
    }

    function startCupDraw(cupName, themeClass) {
        gameState.cupName = cupName;
        const drawPage = document.getElementById('cup-draw-page');
        drawPage.className = `page active ${themeClass}`;
        document.getElementById('cup-name-draw').innerText = cupName;
        document.getElementById('draw-result').innerText = gameState.settings.lang === 'tr' ? "Kura Ã‡ekiliyor..." : "Drawing Lots...";
        document.getElementById('start-cup-match-btn').style.display = "none";

        setTimeout(() => {
            const opps = TEAMS_DATA["premier-lig"].concat(TEAMS_DATA["la-liga"]);
            gameState.cupOpponent = opps[randomInt(0, opps.length-1)];
            document.getElementById('draw-result').innerText = `${gameState.team.name} vs ${gameState.cupOpponent.name}`;
            document.getElementById('start-cup-match-btn').style.display = "inline-block";
        }, 3000);
    }

    function handleCupMatchResult(h, a) {
        const win = h > a;
        let reward = 0;

        if(gameState.cupStage === "YarÄ± Final") {
            if(win) {
                gameState.cupStage = "Final";
                reward = (gameState.cupName.includes("ÅžAMPÄ°YONLAR") || gameState.cupName.includes("CHAMPIONS")) ? 15 : 10;
                gameState.money += reward;
                const title = gameState.settings.lang === 'tr' ? "FÄ°NALE Ã‡IKTINIZ!" : "REACHED THE FINAL!";
                showCupResult(title, (gameState.settings.lang === 'tr' ? `Tebrikler! ${reward}M kazandÄ±nÄ±z.` : `Congrats! Won ${reward}M.`), "cl-theme", false);
            } else {
                reward = 8;
                gameState.money += reward;
                const title = gameState.settings.lang === 'tr' ? "ELENDÄ°NÄ°Z!" : "ELIMINATED!";
                showCupResult(title, (gameState.settings.lang === 'tr' ? `YarÄ± finalde veda ettiniz. ${reward}M kazandÄ±nÄ±z.` : `Out at semi-finals. Won ${reward}M.`), "eliminated-theme", true);
            }
        } else {
            if(win) {
                reward = (gameState.cupName.includes("ÅžAMPÄ°YONLAR") || gameState.cupName.includes("CHAMPIONS")) ? 50 : 30;
                gameState.money += reward;
                const title = gameState.settings.lang === 'tr' ? "ÅžAMPÄ°YON!" : "CHAMPION!";
                showCupResult(title, (gameState.settings.lang === 'tr' ? `KUPAYI KAZANDINIZ! ${reward}M Ã¶dÃ¼l aldÄ±nÄ±z.` : `WON THE CUP! Received ${reward}M.`), "cl-theme", true, true);
            } else {
                reward = 20;
                gameState.money += reward;
                const title = gameState.settings.lang === 'tr' ? "FÄ°NALDE KAYBETTÄ°NÄ°Z!" : "LOST THE FINAL!";
                showCupResult(title, (gameState.settings.lang === 'tr' ? `Ä°kinci oldunuz. ${reward}M kazandÄ±nÄ±z.` : `Runner-up. Won ${reward}M.`), "eliminated-theme", true);
            }
        }
        saveGame();
    }

    function showCupResult(title, info, theme, isEnd, isWinner = false) {
        const resPage = document.getElementById('cup-result-page');
        resPage.className = `page active ${theme}`;
        document.getElementById('cup-res-title').innerText = title;
        document.getElementById('cup-res-info').innerText = info;
        document.getElementById('cup-res-money').style.display = "block";
        
        const btn = document.getElementById('cup-action-btn');
        if(isEnd) {
            btn.innerText = gameState.settings.lang === 'tr' ? "YENÄ° SEZONA BAÅžLA" : "START NEW SEASON";
            btn.onclick = startNewSeason;
        } else {
            btn.innerText = gameState.settings.lang === 'tr' ? "FÄ°NAL MAÃ‡INA GÄ°T" : "GO TO FINAL";
            btn.onclick = () => {
                // Bug Fix: Final kurasÄ±nÄ± baÅŸlat
                startCupDraw(gameState.cupName, theme);
            };
        }
        showPage('cup-result-page');
    }

    function startNewSeason() {
        gameState.season++;
        gameState.currentMatchIndex = 0;
        gameState.isCupActive = false;
        createFixture();
        updateDashboard();
        showPage('dashboard-page');
        toast(gameState.settings.lang === 'tr' ? `${gameState.season}. Sezon BaÅŸladÄ±!` : `Season ${gameState.season} Started!`);
        saveGame();
    }

    function simulateBotMatches() {
        for(let lig in TEAMS_DATA) {
            let teams = TEAMS_DATA[lig].filter(t => t.name !== gameState.team.name);
            for(let i=0; i < teams.length; i+=2) {
                if(teams[i+1]) {
                    const s1 = randomInt(0, 3);
                    const s2 = randomInt(0, 3);
                    updateStandingData(teams[i].name, s1, s2);
                    updateStandingData(teams[i+1].name, s2, s1);
                }
            }
        }
    }

    function updateStandingData(teamName, gf, ga) {  
        const s = gameState.standings[teamName];  
        if(!s) return;
        s.gf += gf; s.ga += ga; s.av += (gf - ga);  
        if(gf > ga) { s.p += 3; s.w++; } else if(gf === ga) { s.p += 1; s.d++; } else { s.l++; }  
    }  

    function showMatchStats() {  
        const panel = document.getElementById('match-stats-panel');  
        panel.style.display = panel.style.display === 'none' ? 'block' : 'none';  
    }  

    function endMatch() { 
        if(gameState.isCupActive) return; 
        showPage('dashboard-page'); 
        updateDashboard(); 
    }  

    let activeSlot = null;
    function showFormation() { 
        showPage('formation-page'); 
        updatePitchUI();
    }

    function updatePitchUI() {
        const slots = ["KL", "SLB", "STP1", "STP2", "SÄžB", "OS1", "OS2", "SLK", "SÄžK", "SNT1", "SNT2"];
        slots.forEach(id => {
            const slot = document.getElementById(`pos-${id}`);
            if(slot) {
                if(gameState.lineup[id]) {
                    slot.innerText = gameState.lineup[id].name.split(" ")[0];
                    slot.classList.add('occupied');
                } else {
                    slot.innerText = id.replace(/[0-9]/g, '');
                    slot.classList.remove('occupied');
                }
            }
        });
    }

    function selectPlayerForPos(posId) {
        activeSlot = posId;
        const modal = document.getElementById('player-select-modal');
        const list = document.getElementById('available-players-list');
        list.innerHTML = "";
        
        const categories = {
            "Kaleciler": ["KL"],
            "Defanslar": ["STP", "SLB", "SÄžB"],
            "Orta Sahalar": ["OS", "OOS", "DOS"],
            "Forvetler": ["SNT", "SLK", "SÄžK"]
        };

        const usedIds = Object.values(gameState.lineup).map(p => p.id);

        for (let catName in categories) {
            const catHeader = document.createElement('div');
            catHeader.className = "pos-header";
            catHeader.innerText = catName;
            list.appendChild(catHeader);

            const catPlayers = gameState.players.filter(p => categories[catName].includes(p.pos) && !usedIds.includes(p.id));
            
            if(catPlayers.length === 0) {
                list.innerHTML += `<p style="font-size:10px; color:gray; padding-left:10px;">Uygun oyuncu yok</p>`;
            }

            catPlayers.forEach(p => {
                const div = document.createElement('div');
                div.className = "player-list-item";
                div.innerHTML = `<span><b>[${p.pos}]</b> ${p.name} (${p.ovr})</span> <button class="btn btn-primary" style="width:auto;" onclick="assignPlayerToPos(${p.id})">SeÃ§</button>`;
                list.appendChild(div);
            });
        }
        modal.style.display = 'flex';
    }

    function assignPlayerToPos(playerId) {
        const player = gameState.players.find(p => p.id === playerId);
        gameState.lineup[activeSlot] = player;
        closePlayerModal();
        updatePitchUI();
        saveGame(); 
    }

    function closePlayerModal() { document.getElementById('player-select-modal').style.display = 'none'; }

    function showTactics() { showPage('tactics-page'); }
    function saveTactics() {
        gameState.tactics.style = document.getElementById('tactic-style').value;
        gameState.tactics.marking = document.getElementById('tactic-marking').value;
        gameState.tactics.aggression = document.getElementById('tactic-aggression').value;
        gameState.tactics.press = document.getElementById('tactic-press').value;
        
        if(!isMatchRunning && currentMatchSecond === 45) {
            gameState.halfTimeTacticUsed = true;
        }

        saveGame(); 
        toast("Saved!");
        if(isMatchRunning || currentMatchSecond === 45) showPage('match-screen-page');
        else showPage('dashboard-page');
    }

    function showSquad() {  
        showPage('squad-page');  
        const container = document.getElementById('my-players-list');  
        container.innerHTML = "";  
        
        let totalVal = 0;
        gameState.players.forEach(p => { totalVal += p.value; });
        document.getElementById('squad-total-value').innerText = totalVal + "M";

        gameState.players.forEach(p => {  
            const div = document.createElement('div');  
            div.className = 'player-list-item';  
            div.innerHTML = `<div style="display:flex; align-items:center; gap:10px;"><div class="overall-badge">${p.ovr}</div><div><b>[${p.pos}] ${p.name}</b></div></div><button class="btn btn-secondary" style="width:auto;" onclick="sellPlayer(${p.id}, ${p.value})">SAT</button>`;  
            container.appendChild(div);  
        });  
    }  

    function sellPlayer(id, val) {
        for(let key in gameState.lineup) {
            if(gameState.lineup[key] && gameState.lineup[key].id === id) delete gameState.lineup[key];
        }
        gameState.players = gameState.players.filter(p => p.id !== id);
        gameState.money += val;
        saveGame(); 
        showSquad();
        updateDashboard();
    }

    function showTransferList() {
        showPage('transfer-page');
        document.getElementById('transfer-money').innerText = gameState.money.toFixed(1);
        const container = document.getElementById('transfer-list-container');
        container.innerHTML = "";
        const tPos = ["KL", "STP", "SLB", "SÄžB", "OS", "SNT"];
        for(let i=0; i<6; i++) {
            const name = PLAYER_NAMES[randomInt(0, PLAYER_NAMES.length-1)];
            const val = randomInt(10, 60);
            const pos = tPos[randomInt(0, 5)];
            const div = document.createElement('div');
            div.className = "player-list-item";
            div.innerHTML = `<span><b>[${pos}]</b> ${name} (${val}M)</span> <button class="btn btn-primary" style="width:auto;" onclick="buyPlayer('${name}', ${val}, '${pos}')">AL</button>`;
            container.appendChild(div);
        }
    }

    function buyPlayer(name, price, pos) {
        if(gameState.money >= price) {
            gameState.money -= price;
            gameState.players.push({ id: Date.now(), name: name + " " + SURNAMES[randomInt(0, 19)], pos: pos, ovr: randomInt(75, 85), value: price });
            saveGame(); 
            toast("Success!");
            showTransferList();
        } else toast("No Money!");
    }

    function showStandings() {  
        showPage('standings-page');  
        renderStandings(gameState.league);
    }  

    function renderStandings(ligKey) {
        const tbody = document.getElementById('standings-body');  
        tbody.innerHTML = "";  
        const sorted = Object.keys(gameState.standings)
            .filter(n => gameState.standings[n].lig === ligKey)
            .sort((a,b) => gameState.standings[b].p - gameState.standings[a].p);  
        
        sorted.forEach((name, i) => {  
            const t = gameState.standings[name];  
            tbody.innerHTML += `<tr><td>${i+1}</td><td>${name}</td><td>${t.w+t.d+t.l}</td><td><b>${t.p}</b></td><td>${t.av}</td></tr>`;  
        });
    }

    function renderMiniStandings() {
        const div = document.getElementById('mini-standings');
        if(!div) return;
        div.innerHTML = "";
        const sorted = Object.keys(gameState.standings)
            .filter(n => gameState.standings[n].lig === gameState.league)
            .sort((a,b) => gameState.standings[b].p - gameState.standings[a].p).slice(0,5);
        sorted.forEach((n, i) => { div.innerHTML += `<div style="font-size:12px; border-bottom:1px solid #333;">${i+1}. ${n} - ${gameState.standings[n].p}p</div>`; });
    }

    function randomInt(min, max) { return Math.floor(Math.random() * (max - min + 1)) + min; }  
    
    function logout() { 
        const modal = document.getElementById('logout-confirm-modal');
        const msg = document.getElementById('logout-message');
        const btn = document.getElementById('logout-primary-btn');

        if(!gameState.user) {
            msg.innerText = gameState.settings.lang === 'tr' ? "Misafir hesabÄ±nda Ã§Ä±kÄ±ÅŸ yaparsanÄ±z tÃ¼m ilerlemeniz kaybolur." : "All progress will be lost on Guest account.";
            btn.innerText = gameState.settings.lang === 'tr' ? "Devam Et" : "Proceed";
        } else {
            msg.innerText = gameState.settings.lang === 'tr' ? "Ã‡Ä±kÄ±ÅŸ yapmak istediÄŸinize emin misiniz?" : "Are you sure you want to logout?";
            btn.innerText = gameState.settings.lang === 'tr' ? "Evet, Ã§Ä±kÄ±ÅŸ yap" : "Yes, logout";
        }
        modal.style.display = 'flex';
    }

    function confirmLogout(action) {
        if(action === 'proceed') {
            location.reload(); 
        } else {
            document.getElementById('logout-confirm-modal').style.display = 'none';
        }
    }

</script>  
</body>  
    </html>
